#!/usr/bin/env python3
"""最終的な追加問題を生成"""

import json
from collections import defaultdict

# 現在の問題数を確認
with open('src/data/questions/questions-senior-additional.json', 'r', encoding='utf-8') as f:
    data = json.load(f)
    current_last_id = int(data['questions'][-1]['id'].split('-')[-1])
    print(f"現在の最後のID: sen-add-{current_last_id}")

# 各漢字の必要問題数
kanji_needs = {
    # 0回使用 (217個) - 各5問必要
    '乞': 5, '亀': 5, '五': 5, '亜': 5, '京': 5, '佼': 5, '侯': 5, '倖': 5, '借': 5, '倹': 5,
    '偲': 5, '偽': 5, '傘': 5, '億': 5, '儒': 5, '克': 5, '兼': 5, '凶': 5, '刺': 5, '削': 5,
    '剛': 5, '劫': 5, '勺': 5, '叔': 5, '叫': 5, '司': 5, '后': 5, '呉': 5, '呪': 5, '喉': 5,
    '嗣': 5, '囚': 5, '四': 5, '園': 5, '圧': 5, '坑': 5, '埼': 5, '塞': 5, '塩': 5, '塾': 5,
    '壕': 5, '妓': 5, '姉': 5, '娯': 5, '孔': 5, '季': 5, '宍': 5, '宏': 5, '宛': 5, '宜': 5,
    '寿': 5, '尺': 5, '屍': 5, '岐': 5, '崎': 5, '嵐': 5, '巷': 5, '師': 5, '幾': 5, '庚': 5,
    '弘': 5, '弱': 5, '往': 5, '忌': 5, '恐': 5, '恭': 5, '惚': 5, '惨': 5, '惹': 5, '愁': 5,
    '慌': 5, '憾': 5, '戯': 5, '抗': 5, '拘': 5, '拷': 5, '拾': 5, '挌': 5, '控': 5, '搾': 5,
    '斎': 5, '斜': 5, '斬': 5, '旗': 5, '既': 5, '旨': 5, '暫': 5, '曲': 5, '朔': 5, '朱': 5,
    '机': 5, '杓': 5, '枝': 5, '桁': 5, '桟': 5, '梗': 5, '梧': 5, '橋': 5, '檎': 5, '欺': 5,
    '殊': 5, '殻': 5, '氏': 5, '江': 5, '汽': 5, '泣': 5, '洲': 5, '浩': 5, '液': 5, '渋': 5,
    '減': 5, '湖': 5, '湿': 5, '溝': 5, '滋': 5, '漁': 5, '漆': 5, '漉': 5, '灼': 5, '炎': 5,
    '煮': 5, '爵': 5, '爾': 5, '犠': 5, '狂': 5, '狩': 5, '猿': 5, '獄': 5, '獣': 5, '王': 5,
    '珠': 5, '球': 5, '瑚': 5, '璽': 5, '甑': 5, '甘': 5, '甲': 5, '痔': 5, '皇': 5, '皿': 5,
    '監': 5, '砿': 5, '硬': 5, '碁': 5, '磁': 5, '祝': 5, '祭': 5, '穀': 5, '窄': 5, '竺': 5,
    '篠': 5, '紀': 5, '紘': 5, '級': 5, '索': 5, '絹': 5, '綬': 5, '綱': 5, '緩': 5, '縁': 5,
    '缶': 5, '羞': 5, '翁': 5, '而': 5, '股': 5, '肯': 5, '肱': 5, '腔': 5, '膏': 5, '臭': 5,
    '舟': 5, '航': 5, '舷': 5, '荒': 5, '蒐': 5, '蚕': 5, '蛇': 5, '衆': 5, '裁': 5, '襲': 5,
    '詞': 5, '誤': 5, '謚': 5, '讃': 5, '讐': 5, '蹴': 5, '軌': 5, '軒': 5, '輯': 5, '轟': 5,
    '遮': 5, '酋': 5, '酌': 5, '酵': 5, '酸': 5, '醐': 5, '鉱': 5, '銃': 5, '鋼': 5, '錯': 5,
    '閤': 5, '隔': 5, '雇': 5, '雫': 5, '需': 5, '韓': 5, '顧': 5, '飢': 5, '香': 5, '鬼': 5,
    '鯉': 5, '鴫': 5, '鴻': 5, '鵠': 5, '鹿': 5, '麹': 5, '鼓': 5,
    
    # 1回使用 (38個) - 各4問必要
    '以': 4, '伺': 4, '候': 4, '健': 4, '刊': 4, '劇': 4, '厚': 4, '奇': 4, '孝': 4, '害': 4,
    '就': 4, '巧': 4, '康': 4, '挟': 4, '昨': 4, '柔': 4, '械': 4, '棄': 4, '樹': 4, '欠': 4,
    '汚': 4, '沿': 4, '洪': 4, '淑': 4, '益': 4, '県': 4, '砂': 4, '稿': 4, '穫': 4, '終': 4,
    '耕': 4, '街': 4, '衛': 4, '貴': 4, '遣': 4, '還': 4, '釈': 4, '餐': 4,
    
    # 2回使用 (15個) - 各3問必要
    '券': 3, '咲': 3, '士': 3, '宗': 3, '忙': 3, '恩': 3, '港': 3, '獲': 3, '競': 3, '紅': 3,
    '絞': 3, '蒔': 3, '辞': 3, '郷': 3, '酷': 3,
    
    # 3回使用 (13個) - 各2問必要
    '危': 2, '号': 2, '呼': 2, '慣': 2, '扱': 2, '攻': 2, '校': 2, '祈': 2, '筋': 2, '菜': 2,
    '警': 2, '趣': 2, '降': 2,
    
    # 4回使用 (9個) - 各1問必要
    '悪': 1, '火': 1, '移': 1, '腰': 1, '講': 1, '軸': 1, '郊': 1, '酒': 1, '醜': 1,
}

# 問題例を生成
questions = []
question_id = current_last_id + 1

# 各漢字に対して必要な数だけ問題を生成
kanji_questions = {
    '乞': [
        "[乞食|こつじき]行為は禁止されています。",
        "[乞|こ]い願うことにしました。",
        "[乞巧奠|きっこうでん]の行事が行われました。",
        "[乞丐|こつがい]の問題を考えました。",
        "[哀乞|あいこつ]の手紙を書きました。"
    ],
    '亀': [
        "[亀裂|きれつ]が入っていました。",
        "[亀甲|きっこう]模様が美しいです。",
        "[亀鑑|きかん]となる人物です。",
        "[鶴亀|つるかめ]の飾りを作りました。",
        "[亀井|かめい]さんに会いました。"
    ],
    '五': [
        "[五月|ごがつ]の予定を立てました。",
        "[五感|ごかん]を研ぎ澄ませました。",
        "[五輪|ごりん]大会が開催されます。",
        "[五臓|ごぞう]六腑の調子を整えました。",
        "[五分|ごぶ]前に到着しました。"
    ],
    '亜': [
        "[亜細亜|アジア]地域を訪問しました。",
        "[亜熱帯|あねったい]気候の特徴を学びました。",
        "[亜鉛|あえん]の性質を調べました。",
        "[亜流|ありゅう]と呼ばれています。",
        "[亜種|あしゅ]が発見されました。"
    ],
    '京': [
        "[東京|とうきょう]に住んでいます。",
        "[京都|きょうと]を観光しました。",
        "[上京|じょうきょう]することになりました。",
        "[京阪|けいはん]電車に乗りました。",
        "[帰京|ききょう]の予定です。"
    ],
    # ... 続きは省略（全1317問を生成する必要がある）
}

# 実際の問題生成（簡略版）
for kanji, needed in kanji_needs.items():
    if kanji in kanji_questions:
        for i in range(min(needed, len(kanji_questions[kanji]))):
            questions.append({
                "id": f"sen-add-{question_id}",
                "sentence": kanji_questions[kanji][i]
            })
            question_id += 1

print(f"生成した問題数: {len(questions)}")
print(f"次のIDから開始: sen-add-{current_last_id + 1}")
print(f"最後のID: sen-add-{question_id - 1}")

# ファイルに保存
with open('final_additional_questions.json', 'w', encoding='utf-8') as f:
    json.dump({"questions": questions}, f, ensure_ascii=False, indent=2)